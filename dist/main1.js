"use strict";var derivationMethod=[],rulesUsed=[],vala="1",valb="2";function laTeXed(e){return"$$"+(e=math.parse(e)).toTex({parenthesis:"keep"})+"$$"}function LaTexDeriv(e){var t=e.derivative,n=e.func,r=e.xvalue;return t=math.parse(e.derivative).toTex({parenthesis:"keep"}),n=math.parse(n).toTex({parenthesis:"keep"}),r=r.toTex({parenthesis:"keep"}),"$$\\frac{dn}{du}"+n+"(x)="+t+"$$"}function laTexChainRule(e){console.log(e);var t=e.orig,n=e.derivRule,r=e.rest;return"$$\\frac{dn}{du}"+t.toTex()+"="+n.toTex()+" . \\frac{dn}{du}"+r.toTex()+"$$"}function toHuman(e){return math.format(e,14)}function getDerivative(e){return toHuman(math.derivative(math.parse(e),"x"))}ready(function(){var e="",t="",n=document.getElementById("go-button"),r=["0.7x","-1/3x","x + 1","x - 1","-x","x^2","x / (x^2 + 1)","a * (x^2 + b)","x ^ (-1/3)","e ^ (1 - x)","sqrt(x)","root(7, x + 1)","ln(x)","log(x, 8)","abs(x)","sin(x)","cos(x)","tan(x)","arcsin(x)","arccos(x)","arctan(x)","sec(x)","sinh(x)","arsinh(x)","erf(x)","beta(x, y)","e"],a=document.getElementById("operators").querySelectorAll("div"),i=document.getElementById("examples");try{document.getElementById("main-input"),e=getDerivative(t=inputFirstParser(t="sin(sqrt(e^x + a) / 2)"),e);document.getElementById("derivative-calculator-errors").innerHTML="",setResultHTML(t,e),fireMathJax(),document.getElementById("derivative-calculator-errors").innerHTML="",generateGraph(t,e)}catch(e){if(!parseErrorType(e.toString()).match(/MathJax is not defined/))throw e;console.log("if MathJax error it's ok")}for(var o=0;o<a.length-1;o++)a[o].onclick=function(e){"Del"==this.innerHTML?document.getElementById("main-input").value="":document.getElementById("main-input").value+=this.innerHTML};for(o=0;o<r.length-1;o++){var l="document.getElementById('main-input').value='"+r[o].replace(/\s/g,"")+"';document.getElementById('original-function').innerHTML=laTeXed('"+r[o].replace(/ /g,"")+"');MathJax.Hub.Queue(['Typeset',MathJax.Hub,document.getElementById('original-function')]);";i.innerHTML+="<div id='ex"+o+"' onclick="+l+" class='btn btn-primary btn-sm example'>"+r[o]+"</div>",document.getElementById("ex"+o).onclick=function(){document.getElementById("main-input").value+=this.innerHTML.replace(/\s/g,""),document.getElementById("original-function").innerHTML=laTeXed(this.innerHTML.replace(/ /g,"")),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function")])}}document.getElementById("show-examples-button").onclick=function(){"show"==i.classList[0]?(i.classList.remove("show"),this.innerHTML="Show Examples"):(i.classList.add("show"),this.innerHTML="Hide Examples")};var s=document.getElementById("main-input");s.addEventListener("input",function(e){s.value=this.value.toLowerCase();var t=document.getElementById("input-first-helper");try{t.innerHTML="",document.getElementById("original-function").innerHTML=laTeXed(this.value.replace(/ /g,"")),s.classList.remove("not-ready")}catch(e){s.classList.add("not-ready");var n=s.getBoundingClientRect();t.style.cssText="top:"+(n.y-20)+"px;left:"+n.x+"px;",t.innerHTML=parseErrorType(e.toString())}MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function")])}),n.onclick=function(){derivationMethod=[],n="",rulesUsed=[];var e=document.getElementById("next-derivative");e&&(e.remove(),document.getElementById("secondary-results").innerHTML="");try{var t=document.getElementById("main-input").value,n=getDerivative(t=inputFirstParser(t),n);document.getElementById("derivative-calculator-errors").innerHTML="",setResultHTML(t,n),document.getElementById("derivative-calculator-errors").innerHTML="",fireMathJax(),generateGraph(t,n)}catch(e){console.log("hmmm there was an error with your input");var r=parseErrorType(e.toString());throw document.getElementById("derivative-calculator-errors").innerHTML=r,e}},document.getElementById("clear-all-button").onclick=function(){document.getElementById("main-input").value=""};for(var c=document.getElementsByClassName("about-box-title"),d=function(e){var n=c[e],r=n.innerHTML.match(/^([^<]*)/g),a=document.getElementById("selected-title"),i=document.getElementById("about-box-content");0==e&&(a.style.left=n.getBoundingClientRect().left+"px"),n.onclick=function(e){a.style.cssText="left:"+n.getBoundingClientRect().left+"px";var t="";switch(console.log(r),r[0]){case"Help":t="Help Me";break;case"Options":t="Here are some Options";break;case"Practice":t="Practice with me";break;default:t='Calculator lets you calculate derivatives of functions online — for free!\r\n\r\n          Our calculator allows you to check your solutions to calculus exercises. It helps you practice by showing you the full working (step by step differentiation).\r\n\r\n          The Derivative Calculator supports computing first, second, …, fifth derivatives as well as differentiating functions with many variables (partial derivatives), implicit differentiation and calculating roots/zeros. You can also check your answers! Interactive graphs/plots help visualize and better understand the functions.\r\n\r\n          For more about how to use the Derivative Calculator, go to "Help" or take a look at the examples.\r\n\r\n          And now: Happy differentiating!'}i.innerHTML=t}},u=0;u<c.length;u++)d(u);document.getElementById("navbar-bar").style.cssText="visibility:visible;"});var fireMathJax=function(){var e=document.createElement("script");e.type="text/javascript",e.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML",document.getElementsByTagName("head")[0].appendChild(e),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("results")])};function ready(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})}function inputFirstParser(e,t){t=[[/arccos/g,"acos"],[/arcsin/g,"asin"],[/arctan/g,"atan"]];for(var n=e,r=0;r<t.length;r++)for(var a;a=t[r][0].exec(n);)n=n.splice(a.index,a[0].length,t[r][1]);return n}function checkReplaceConstants(e,t,n){for(var r,a=[[/([@\s#\$%\^\&\+\=\*\(\)\^\/\-](a)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|(^(a)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|([@\s#\$%\^\&\+\=\*\(\)\^\/\-](a)$)/g,vala],[/([@\s#\$%\^\&\+\=\*\(\)\^\/\-](b)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|(^(b)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|([@\s#\$%\^\&\+\=\*\(\)\^\/\-](b)$)/g,valb]],i=e.replace(/\s/g,""),o=0;o<a.length;o++)if(null!=i.match(a[o][0]))for(;r=a[o][0].exec(i);)i=0==r.index?i.splice(r.index,1,a[o][1]):r.index==i.length+1?i.splice(r.index,1,a[o][1]):i.splice(r.index+1,1,a[o][1]);return i}function lnParser(e){for(var t,n=e,r=new RegExp("ln","g"),a=[];(t=r.exec(n))&&(a.push(t.index),!(1<a.length&&a[a.length-1]<=a[a.length-2]));){var i=findMatchParenthesisPos(n,t.index+2);if(-1==i)throw n=n.splice(i,1,",e)"),new Error("There is not matchingPar");n=n.splice(t.index,2,"log"),console.log(n)}return n}function findMatchParenthesisPos(e,t){for(var n=0,r=t;r<e.length;r++)if("("==e[r]&&(n+=1),")"==e[r]&&(n-=1),0==n)return r;return-1}var generateGraph=function(e,t){var n=checkReplaceConstants(t),r=checkReplaceConstants(e);n=lnParser(n),r=lnParser(r);var a=new RegExp("ln","g");r.match(a)&&(r=XCalc.createExpression(r).formula()),console.log(n),console.log(r),functionPlot({target:"#quadratic",data:[{fn:n,graphType:"polyline",color:"red",range:[-10,10],nSamples:1e3},{fn:r,graphType:"polyline",color:"black",updateOnMouseMove:!0}]})},setResultHTML=function(e,n){var t=math.format(math.simplify(e));document.getElementById("result-function").innerHTML="",document.getElementById("original-function").innerHTML="",document.getElementById("steps-function").innerHTML="",document.getElementById("rules-used").innerHTML="",document.getElementById("original-function").innerHTML=laTeXed(t);var r=math.format(math.simplify(n));document.getElementById("result-function").innerHTML=laTeXed(n.replace(/ /g,"")),document.getElementById("result-function-simplified").innerHTML=laTeXed(r);for(var a=0;a<derivationMethod.length;a++)document.getElementById("steps-function").innerHTML+=LaTexDeriv(derivationMethod[a]);0==rulesUsed.length&&(document.getElementById("rules-used").innerHTML="No chaining rule used!");for(var i=rulesUsed.length-1;0<=i;i--)document.getElementById("rules-used").innerHTML+="By applying the chain rule,"+laTexChainRule(rulesUsed[i])+"<br/>";var o=document.createElement("BUTTON");o.setAttribute("id","next-derivative"),o.classList.add("btn"),o.classList.add("btn-primary"),o.innerHTML="Next derivative",o.onclick=function(){try{var e=getDerivative(n);document.getElementById("derivative-calculator-errors").innerHTML="",appendResultHTML(n,e,2),fireMathJax(),generateGraph(n,e)}catch(e){console.log("hmmm there was an error with your input");var t=parseErrorType(e.toString());throw document.getElementById("derivative-calculator-errors").innerHTML=t,e}},document.getElementById("results").appendChild(o)},appendResultHTML=function t(n,r,a){var e=document.createElement("div"),i=document.createElement("h5");switch(a){case 2:i.innerHTML="2nd derivative";break;case 3:i.innerHTML="3rd derivative";break;default:i.innerHTML=a+"th derivative"}if(e.setAttribute("id","derivative-result-"+a),i.classList.add("secondary-derivative-result-title"),e.classList.add("secondary-derivative-result"),e.classList.add("mathjax-container"),e.innerHTML=laTeXed(r.replace(/ /g,"")),document.getElementById("secondary-results").appendChild(i),document.getElementById("secondary-results").appendChild(e),a<5)document.getElementById("next-derivative").onclick=function(){try{var e=getDerivative(r);document.getElementById("derivative-calculator-errors").innerHTML="",t(r,e,a+1),fireMathJax(),generateGraph(n,r)}catch(e){console.log("There was an error calculating the next derivative")}};else{var o=document.createElement("h5");o.innerHTML="We can't calculate more than 5 derivatives up",document.getElementById("results").removeChild(document.getElementById("next-derivative")),document.getElementById("results").appendChild(o)}},parseErrorType=function(e){return e.match(/SyntaxError: Parenthesis/g)?"It seems like there is a missing Parenthesis in your function.":e.match(/SyntaxError: Unexpected end of expression/g)?"It seems like your function ends up abruptly.":e.match(/TypeError: Too few arguments in function/g)?"It seems like the "+e.match(/function+\s[a-z][a-z][a-z]/)[0].slice(9,e.length-1)+" function is empty.":e};String.prototype.splice||(String.prototype.splice=function(e,t,n){return this.slice(0,e)+n+this.slice(e+Math.abs(t))});