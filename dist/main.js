"use strict";var vala="1",valb="2",derivationMethod=[],rulesUsed=[],exampleList=["0.7x","-1/3x","x + 1","x - 1","-x","x^2","x / (x^2 + 1)","a * (x^2 + b)","x ^ (-1/3)","e ^ (1 - x)","sqrt(x)","root(7, x + 1)","ln(x)","log(x, 8)","abs(x)","sin(x)","cos(x)","tan(x)","arcsin(x)","arccos(x)","arctan(x)","sec(x)","sinh(x)","arsinh(x)","erf(x)","beta(x, y)","e"],unsupportedPlotDerivatives=["ln","arccos","sec"];function laTeXed(e){var n="$$"+(e=math.parse(e)).toTex({parenthesis:"keep"})+"$$";return console.log(n),n}function LaTexDeriv(e){var n=math.parse(e.derivative);return"$$\\frac{dn}{du}"+e.func+"(x)="+n.toTex({parenthesis:"keep"})+"$$"}function toHuman(e){return math.format(e,14)}function getDerivative(e){var n=[];return n.push(toHuman(math.derivative(math.parse(e),"x"))),n}var fireMathJax=function(){var e=document.createElement("script");e.type="text/javascript",e.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML",document.getElementsByTagName("head")[0].appendChild(e),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function")]),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("result-function")]),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("result-function-simplified")]),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function-simplified")]),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("steps-function")]),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("rules-used")])};function ready(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})}function inputFirstParser(e,n){n=[[/arccos/g,"acos"],[/arcsin/g,"asin"],[/arctan/g,"atan"]];var t=e;console.log(n.length);for(var a=0;a<n.length;a++){for(var o;o=n[a][0].exec(t);)console.log(o),t=t.splice(o.index,o[0].length,n[a][1]);console.log(t)}return console.log(t),t}function checkReplaceConstants(e,n,t){for(var a,o=[[/([@\s#\$%\^\&\+\=\*\(\)\^\/\-](a)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|(^(a)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|([@\s#\$%\^\&\+\=\*\(\)\^\/\-](a)$)/g,vala],[/([@\s#\$%\^\&\+\=\*\(\)\^\/\-](b)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|(^(b)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|([@\s#\$%\^\&\+\=\*\(\)\^\/\-](b)$)/g,valb]],i=e.replace(/\s/g,""),l=0;l<o.length;l++)if(null!=i.match(o[l][0]))for(;a=o[l][0].exec(i);)i=0==a.index?i.splice(a.index,1,o[l][1]):a.index==i.length+1?i.splice(a.index,1,o[l][1]):i.splice(a.index+1,1,o[l][1]),console.log(i);return i}function lnParser(e){for(var n,t=e,a=new RegExp("ln","g"),o=[];(n=a.exec(t))&&(o.push(n.index),!(1<o.length&&o[o.length-1]<=o[o.length-2]));){console.log("match that index is "+n.index);var i=findMatchParenthesisPos(t,n.index+2);if(console.log(i),-1==i)throw t=t.splice(i,1,",e)"),new Error("There is not matchingPar");t=t.splice(n.index,2,"log"),console.log(t)}return t}function findMatchParenthesisPos(e,n){for(var t=0,a=n;a<e.length;a++)if("("==e[a]&&(t+=1),")"==e[a]&&(t-=1),0==t)return a;return-1}ready(function(){for(var e=function(e){return"#"===e.charAt(0)?document.querySelector(e):document.querySelectorAll(e)},i=e("#main-input"),n=e("#go-button"),l=[],r="",t=document.getElementById("operators").querySelectorAll("div"),a=document.getElementById("examples"),o=0;o<t.length-1;o++)t[o].onclick=function(e){"Del"==this.innerHTML?document.getElementById("main-input").value="":document.getElementById("main-input").value+=this.innerHTML};for(o=0;o<exampleList.length-1;o++){var c="document.getElementById('main-input').value='"+exampleList[o].replace(/\s/g,"")+"';document.getElementById('original-function').innerHTML=laTeXed('"+exampleList[o].replace(/ /g,"")+"');MathJax.Hub.Queue(['Typeset',MathJax.Hub,document.getElementById('original-function')]);";a.innerHTML+="<div id='ex"+o+"' onclick="+c+" class='example'>"+exampleList[o]+"</div>",document.getElementById("ex"+o).onclick=function(){console.log(this),document.getElementById("main-input").value+=this.innerHTML.replace(/\s/g,""),document.getElementById("original-function").innerHTML=laTeXed(this.innerHTML.replace(/ /g,"")),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function")])}}document.getElementById("show-examples-button").onclick=function(){"show"==a.classList[0]?(a.classList.remove("show"),this.innerHTML="Show Examples"):(a.classList.add("show"),this.innerHTML="Hide Examples")},document.getElementById("main-input").addEventListener("input",function(e){document.getElementById("original-function").innerHTML=laTeXed(this.value.replace(/ /g,"")),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function")])}),n.onclick=function(){derivationMethod=[],l=[],rulesUsed=[];try{!function(){r=inputFirstParser(r=i.value);try{var e=math.format(math.simplify(r));console.log("succes")}catch(e){console.log("noooo")}l=getDerivative(r),console.log(r),console.log(l),document.getElementById("result-function").innerHTML="",document.getElementById("original-function").innerHTML="",document.getElementById("steps-function").innerHTML="",document.getElementById("rules-used").innerHTML="",document.getElementById("original-function").innerHTML=laTeXed(r.replace(/ /g,"")),document.getElementById("original-function-simplified").innerHTML=laTeXed(e);for(var n=0;n<l.length;n++){var t=math.format(math.simplify(l[n]));document.getElementById("result-function").innerHTML+=laTeXed(l[n].replace(/ /g,"")),document.getElementById("result-function-simplified").innerHTML+=laTeXed(t)}for(var a=0;a<derivationMethod.length;a++)console.log(derivationMethod[a].derivative),document.getElementById("steps-function").innerHTML+=LaTexDeriv(derivationMethod[a]);0==rulesUsed.length&&(document.getElementById("rules-used").innerHTML="No chaining rule used!");for(var o=0;o<rulesUsed.length;o++)document.getElementById("rules-used").innerHTML+=rulesUsed[o]+"\n";fireMathJax(),s()}()}catch(e){console.log("error")}};var s=function(){var e=checkReplaceConstants(l[0]),n=checkReplaceConstants(r);e=lnParser(e),n=lnParser(n);var t=new RegExp("ln","g");n.match(t)&&(console.log("found"),n=XCalc.createExpression(n).formula()),console.log(e),console.log(n),functionPlot({target:"#quadratic",data:[{fn:e,graphType:"polyline",color:"red",range:[-10,10],nSamples:1e3},{fn:n,graphType:"polyline",color:"black",updateOnMouseMove:!0}]})}}),String.prototype.splice||(String.prototype.splice=function(e,n,t){return this.slice(0,e)+t+this.slice(e+Math.abs(n))});