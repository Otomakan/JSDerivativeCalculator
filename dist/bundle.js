"use strict";var XCalc=function(){function F(e){(this.operator=e)||XCalc.log("Operator has no input."),this.solve=function(e,t,s){var n=e.coefficient;"variable"==e.type&&(n=s);var i=t.coefficient;return"variable"==t.type&&(i=s),"+"==this.operator?new $(n+i):"-"==this.operator?new $(n-i):"*"==this.operator?new $(n*i):"/"==this.operator?new $(n/i):"^"==this.operator?new $(Math.pow(n,i)):void 0}}function O(e){(this.f=e)||XCalc.log("Math function has no input."),this.solve=function(e){var t=e.coefficient;return console.log(this.f),console.log("fdsfsdfd"),"sin"==this.f?new $(Math.sin(t)):"cos"==this.f?new $(Math.cos(t)):"tan"==this.f?new $(Math.tan(t)):"asin"==this.f?new $(Math.asin(t)):"acos"==this.f?new $(Math.acos(t)):"atan"==this.f?new $(Math.atan(t)):"abs"==this.f?new $(Math.abs(t)):"log"==this.f?new $(Math.log(t)/Math.log(10)):"ln"==this.f?new $(Math.log(t)):void 0}}function X(e){(this.c=e)||XCalc.log("Math function has no input."),this.solve=function(){return"pi"==this.c?new $(Math.PI):"e"==this.c?new $(Math.E):"i"==this.c?new $(Math.E):void 0},this.prettyC=function(){return"pi"==this.c?"&pi;":"e"==this.c?"e":void 0}}function $(e){this.sections=[],this.type="section",this.operator=0,this.coefficient=0,this.mathFunction=0,this.mathConstant=0,this.variable="";var t=function(e,t){var s=!0,n=-1;n="^"!=e?t.lastIndexOf(e):t.indexOf(e);for(;s;){for(var i=0,o=0;o<t.length;o++)if("("==t.substr(o,1)?i++:")"==t.substr(o,1)&&i--,o==n){if(0===i&&("-"!=e||0<o&&-1=="+-/*^".indexOf(t.substr(o-1,1))||0===o)||1==i&&"("==e){s=!1;break}n="^"!=e?t.substring(0,n).lastIndexOf(e):-1==t.substring(n+1).indexOf(e)?-1:n+1+t.substring(n+1).indexOf(e)}-1==n&&(s=!1)}return n},s=function(e,t){var s=0,n=-1,i=0;if("sin"==e)i=/(a)?sin/g;else if("cos"==e)i=/(a)?cos/g;else{if("tan"!=e)return-1;i=/(a)?tan/g}for(s=i.exec(t);s;s=i.exec(t))"a"!=RegExp.$1&&(n=s.index);for(var o=!0;o&&-1!=n;){for(var r=0,c=0;c<t.length;c++)if("("==t.substr(c,1)?r++:")"==t.substr(c,1)&&r--,c==n){if(0===r){o=!1;break}var a=t.substring(0,n);for(n=-1,s=i.exec(a);s;s=i.exec(a))"a"!=RegExp.$1&&(n=s.index)}-1==n&&(o=!1)}return"cos"==e&&console.log(n),n};if(this.containsX=function(){return"variable"==this.type||"value"!=this.type&&(1==this.sections.length?this.sections[0].containsX():2==this.sections.length?this.sections[0].containsX()||this.sections[1].containsX():void 0)},this.containsConstant=function(){return"constant"==this.type||"value"!=this.type&&(1==this.sections.length?this.sections[0].containsConstant():2==this.sections.length?this.sections[0].containsConstant()||this.sections[1].containsConstant():void 0)},this.equals=function(e){return this.type==e.type&&("function"==this.type?this.mathFunction.f==e.mathFunction.f&&this.sections[0].equals(e.sections[0]):"variable"==this.type?this.variable==e.variable&&this.coefficient==e.coefficient:"constant"==this.type?this.mathConstant.c==e.mathConstant.c:"value"==this.type?this.coefficient==e.coefficient:"section"==this.type?"*"==this.operator.operator||"+"==this.operator.operator?this.operator.operator==e.operator.operator&&(this.sections[0].equals(e.sections[0])&&this.sections[1].equals(e.sections[1])||this.sections[0].equals(e.sections[1])&&this.sections[1].equals(e.sections[0])):this.operator.operator==e.operator.operator&&this.sections[0].equals(e.sections[0])&&this.sections[1].equals(e.sections[1]):void 0)},this.solve=function(e){return e||(e=0),"value"==this.type?this:"variable"==this.type?new $(e):"constant"==this.type?this.mathConstant.solve():"function"==this.type?this.mathFunction.solve(this.sections[0].solve(e)):1==this.sections.length?this.sections[0].solve(e):2==this.sections.length?this.operator.solve(this.sections[0].solve(e),this.sections[1].solve(e),e):void 0},this.result=function(e){return this.solve(e).coefficient},this.simplify=function(){var e,t=new $(this);if(t.containsX()&&"variable"!=t.type){for(var s=0;s<t.sections.length;s++)t.sections[s]=t.sections[s].simplify();if("section"==t.type)if("+"==t.operator.operator)"value"==t.sections[0].type&&0===t.sections[0].coefficient?t=t.sections[1]:"value"==t.sections[1].type&&0===t.sections[1].coefficient&&(t=t.sections[0]);else if("-"==t.operator.operator)"value"==t.sections[1].type&&0===t.sections[1].coefficient&&(t=t.sections[1]);else if("*"==t.operator.operator)if("value"==t.sections[0].type&&1==t.sections[0].coefficient)t=new $(t.sections[1]);else if("value"==t.sections[1].type&&1==t.sections[1].coefficient)t=new $(t.sections[0]);else if("value"==t.sections[0].type&&0===t.sections[0].coefficient||"value"==t.sections[1].type&&0===t.sections[1].coefficient)t=new $(0);else if("section"==t.sections[1].type&&"/"==t.sections[1].operator.operator&&"value"==t.sections[1].sections[0].type&&1==t.sections[1].sections[0].coefficient)t.operator=new F("/"),t.sections[1]=t.sections[1].sections[1];else if("section"==t.sections[0].type&&"/"==t.sections[0].operator.operator&&"value"==t.sections[0].sections[0].type&&1==t.sections[0].sections[0].coefficient){t.operator=new F("/");var n=t.sections[1];t.sections[1]=t.sections[0].sections[1],t.sections[0]=n}else if("section"==t.sections[0].type&&"^"==t.sections[0].operator.operator&&"section"==t.sections[1].type&&"^"==t.sections[1].operator.operator&&t.sections[0].sections[0].equals(t.sections[1].sections[0])){var i=new $(0);i.type="section",i.sections.push(t.sections[0].sections[1]),i.sections.push(t.sections[1].sections[1]),i.operator=new F("+"),t.sections[0]=t.sections[0].sections[0],t.sections[1]=i,t.operator=new F("^")}else"section"==t.sections[0].type&&"*"==t.sections[0].operator.operator?((e=new $(0)).operator=new F("*"),e.type="section",t.sections[0].sections[1].containsX()?t.sections[0].sections[0].containsX()||(t.sections[0].sections[1].containsX()?(e.sections.push(t.sections[0].sections[1]),e.sections.push(t.sections[1]),t.sections[0]=t.sections[0].sections[0]):(e.sections.push(t.sections[0].sections[0]),e.sections.push(t.sections[1]),t.sections[0]=t.sections[0].sections[1]),t.sections[1]=e):(t.sections[0].sections[0].containsX()?(e.sections.push(t.sections[0].sections[0]),e.sections.push(t.sections[1]),t.sections[0]=t.sections[0].sections[1]):(e.sections.push(t.sections[0].sections[1]),e.sections.push(t.sections[1]),t.sections[0]=t.sections[0].sections[0]),t.sections[1]=e)):"section"==t.sections[1].type&&"*"==t.sections[1].operator.operator&&((e=new $(0)).operator=new F("*"),e.type="section",t.sections[1].sections[1].containsX()?t.sections[1].sections[0].containsX()||(t.sections[1].sections[1].containsX()?(e.sections.push(t.sections[1].sections[1]),e.sections.push(t.sections[0]),t.sections[1]=t.sections[1].sections[0]):(e.sections.push(t.sections[1].sections[0]),e.sections.push(t.sections[0]),t.sections[1]=t.sections[1].sections[1]),t.sections[0]=e):(t.sections[1].sections[0].containsX()?(e.sections.push(t.sections[1].sections[0]),e.sections.push(t.sections[0]),t.sections[1]=t.sections[1].sections[1]):(e.sections.push(t.sections[1].sections[1]),e.sections.push(t.sections[0]),t.sections[1]=t.sections[1].sections[0]),t.sections[0]=e));else if("/"==t.operator.operator){if("value"==t.sections[1].type&&1==t.sections[1].coefficient)t=t.sections[0];else if(t.sections[0].equals(t.sections[1]))t=new $(1);else if("section"==t.sections[0].type&&"^"==t.sections[0].operator.operator&&"section"==t.sections[1].type&&"^"==t.sections[1].operator.operator&&t.sections[0].sections[0].equals(t.sections[1].sections[0])){var o=new $(0);o.type="section",o.sections.push(t.sections[0].sections[1]),o.sections.push(t.sections[1].sections[1]),o.operator=new F("-"),t.sections[0]=t.sections[0].sections[0],t.sections[1]=o,t.operator=new F("^")}}else if("^"==t.operator.operator)if("value"==t.sections[1].type&&1==t.sections[1].coefficient)t=t.sections[0];else if("value"==t.sections[1].type&&0===t.sections[1].coefficient)t=new $(0);else if("value"==t.sections[0].type&&1==t.sections[0].coefficient)t=new $(1);else if("section"==t.sections[0].type&&("/"==t.sections[0].operator.operator||"/"==t.sections[0].operator.operator)){var r=new $(0);r.type="section",r.operator=new F("^"),r.sections.push(t.sections[0].sections[0]),r.sections.push(t.sections[1]);var c=new $(0);c.type="section",c.operator=new F("^"),c.sections.push(t.sections[0].sections[1]),c.sections.push(t.sections[1]),t.operator=t.sections[0].operator,t.sections[0]=r,t.sections[1]=c}}else"variable"==t.type||t.containsConstant()&&t.result()%1!=0||(t.coefficient=t.result(),t.type="value");return this.equals(t)?this:t.simplify()},this.derivative=function(){var e,t,s,n,i=new $(this),o=new $(0);if("variable"==i.type)o.coefficient=1;else if("value"!=i.type&&"constant"!=i.type&&i.containsX())if("section"==i.type&&"^"!=i.operator.operator){if("+"==i.operator.operator)o.type="section",o.sections.push(i.sections[0].derivative()),o.sections.push(i.sections[1].derivative()),o.operator=new F("+");else if("-"==i.operator.operator)o.type="section",o.sections.push(i.sections[0].derivative()),o.sections.push(i.sections[1].derivative()),o.operator=new F("-");else if("*"==i.operator.operator)(e=new $(0)).type="section",e.sections.push(i.sections[0].derivative()),e.sections.push(i.sections[1]),e.operator=new F("*"),(t=new $(0)).type="section",t.sections.push(i.sections[0]),t.sections.push(i.sections[1].derivative()),t.operator=new F("*"),o.type="section",o.sections.push(e),o.sections.push(t),o.operator=new F("+");else if("/"==i.operator.operator){(e=new $(0)).type="section",e.sections.push(i.sections[0].derivative()),e.sections.push(i.sections[1]),e.operator=new F("*"),(t=new $(0)).type="section",t.sections.push(i.sections[1].derivative()),t.sections.push(i.sections[0]),t.operator=new F("*");var r=new $(0);r.type="section",r.sections.push(e),r.sections.push(t),r.operator=new F("-");var c=new $(0);c.type="section",c.sections.push(i.sections[1]),c.sections.push(new $(2)),c.operator=new F("^"),o.type="section",o.sections.push(r),o.sections.push(c),o.operator=new F("/")}}else{var a;if(((e=new $(0)).type="section")==i.type&&"^"==i.operator.operator)if(i.sections[1].containsX()&&i.sections[0].containsX())e=i,(t=new $(0)).type="function",t.sections.push(i.sections[0]),t.mathFunction=new O("ln"),(s=new $(0)).type="section",s.sections.push(i.sections[1]),s.sections.push(t),s.operator=new F("*"),a=s.derivative();else if(i.sections[1].containsX())(t=new $(0)).type="function",t.sections.push(i.sections[0]),t.mathFunction=new O("ln"),e.sections.push(i),e.sections.push(t),e.operator=new F("*"),a=i.sections[1].derivative();else{var u=new $(0);u.type="section",u.sections.push(i.sections[1]),u.sections.push(new $(1)),u.operator=new F("-"),(t=new $(0)).type="section",t.sections.push(i.sections[0]),t.sections.push(u),t.operator=new F("^"),e.sections.push(i.sections[1]),e.sections.push(t),e.operator=new F("*"),a=i.sections[0].derivative()}else if(a=i.sections[0].derivative(),"ln"==i.mathFunction.f)e.sections.push(new $(1)),e.sections.push(i.sections[0]),e.operator=new F("/");else if("log"==i.mathFunction.f)(t=new $(0)).mathFunction=new O("ln"),t.type="function",t.sections.push(new $(10)),(s=new $(0)).type="section",s.sections.push(i.sections[0]),s.sections.push(t),s.operator=new F("*"),e.sections.push(new $(1)),e.sections.push(s),e.operator=new F("/");else if("sin"==i.mathFunction.f)e.mathFunction=new O("cos"),e.type="function",e.sections.push(i.sections[0]);else if("cos"==i.mathFunction.f)(t=new $(0)).mathFunction=new O("sin"),t.type="function",t.sections.push(i.sections[0]),e.sections.push(new $(0)),e.sections.push(t),e.operator=new F("-");else if("tan"==i.mathFunction.f)(t=new $(0)).mathFunction=new O("cos"),t.type="function",t.sections.push(i.sections[0]),(s=new $(0)).type="section",s.sections.push(t),s.sections.push(new $(2)),s.operator=new F("^"),e.sections.push(new $(1)),e.sections.push(s),e.operator=new F("/");else if("asin"==i.mathFunction.f)(t=new $(0)).type="section",t.sections.push(i.sections[0]),t.sections.push(new $(2)),t.operator=new F("^"),(s=new $(0)).type="section",s.sections.push(new $(1)),s.sections.push(t),s.operator=new F("-"),(n=new $(0)).type="section",n.sections.push(s),n.sections.push(new $(.5)),n.operator=new F("^"),e.sections.push(new $(1)),e.sections.push(n),e.operator=new F("/");else if("acos"==i.mathFunction.f){(t=new $(0)).type="section",t.sections.push(i.sections[0]),t.sections.push(new $(2)),t.operator=new F("^"),(s=new $(0)).type="section",s.sections.push(new $(1)),s.sections.push(t),s.operator=new F("-"),(n=new $(0)).type="section",n.sections.push(new $(0)),n.sections.push(new $(1)),n.operator=new F("-");var h=new $(0);h.type="section",h.sections.push(s),h.sections.push(new $(.5)),h.operator=new F("^"),e.sections.push(n),e.sections.push(h),e.operator=new F("/")}else"atan"==i.mathFunction.f&&((t=new $(0)).type="section",t.sections.push(i.sections[0]),t.sections.push(new $(2)),t.operator=new F("^"),(s=new $(0)).type="section",s.sections.push(t),s.sections.push(new $(1)),s.operator=new F("+"),e.sections.push(new $(1)),e.sections.push(s),e.operator=new F("/"));o.type="section",o.sections.push(e),o.sections.push(a),o.operator=new F("*")}else o.coefficient=0;return o},this.formula=function(){var e="";return"value"==this.type?e+=this.coefficient:"variable"==this.type?e+="x":"constant"==this.type?e+=this.mathConstant.c:"function"==this.type?e+=this.mathFunction.f+"("+this.sections[0].formula()+")":"section"==this.type&&("section"==this.sections[0].type?e+="("+this.sections[0].formula()+")":e+=this.sections[0].formula(),e+=this.operator.operator,"section"==this.sections[1].type?e+="("+this.sections[1].formula()+")":e+=this.sections[1].formula()),e},this.derive=function(){return this.simplify().derivative().simplify()},this.prettyFormula=function(){var e="<div class='group "+this.type+("section"==this.type&&"/"==this.operator.operator?" division":"")+"'>";return"value"==this.type?e+=this.coefficient:"variable"==this.type?e+="x":"constant"==this.type?e+=this.mathConstant.prettyC():"function"==this.type?e+=this.mathFunction.f+"("+this.sections[0].prettyFormula()+")":"section"==this.type&&("section"==this.sections[0].type&&"/"!=this.sections[0].operator.operator?e+="("+this.sections[0].prettyFormula()+")":e+=this.sections[0].prettyFormula(),"*"==this.operator.operator?e+="<span class='operator'>&times</span>":"^"!=this.operator.operator&&"/"!=this.operator.operator&&(e+="<span class='operator'>"+this.operator.operator+"</span>"),"^"==this.operator.operator?e+="<div class='group exponent'>"+this.sections[1].prettyFormula()+"</div>":"/"==this.operator.operator?e+="<div class='group denom'>"+this.sections[1].prettyFormula()+"</div>":"section"==this.sections[1].type&&"/"!=this.sections[0].operator.operator?e+="("+this.sections[1].prettyFormula()+")":e+=this.sections[1].prettyFormula()),e+="</div>"},void 0!==e){if("string"==typeof e){var n=t("+",e=function(e){if(!e)return"";for(;"("==e.substr(0,1)&&")"==e.substr(e.length-1,1);){for(var t=1,s=1;s<e.length&&0<t;s++)"("==e.substr(s,1)&&t++,")"==e.substr(s,1)&&t--;if(s-=1,0!==t||s!=e.length-1)break;e=e.substring(1,e.length-1)}return e}(e=e.replace(/\s/g,""))),i=t("-",e),o=t("/",e),r=t("^",e),c=t("(",e),a=s("sin",e),u=s("cos",e),h=s("tan",e),p=t("asin",e),l=t("acos",e),f=t("atan",e),d=t("abs",e),m=t("log",e),v=t("ln",e),y=t("sqrt",e),g=t("e",e),w=t("pi",e),x=t("i",e),b=t("*",e),M=function(e){var t=!0,s=!0,n=-1,i=-1,o="+-/*^sincostanabsloglnsqrt";for(n=e.lastIndexOf("("),i=e.lastIndexOf(")");t||s;){for(var r=0,c=0;c<e.length;c++)"("==e.substr(c,1)?r++:")"==e.substr(c,1)&&r--,c==n&&t&&(1==r&&0!==c&&-1==o.indexOf(e.substr(c-1,1))?t=!1:n=e.substring(0,n).lastIndexOf("(")),c==i&&s&&(0===r&&c<e.length-1&&-1==o.indexOf(e.substr(c+1,1))?s=!1:i=e.substring(0,i).lastIndexOf(")"));-1==n&&(t=!1),-1==i&&(s=!1)}return n<i&&-1!=i?i:n}(e),E=t("x",e),T=t("X",e);E<T&&(E=T);var L=-1,I="+-/*^sincostanabsloglnsqrt";if(b<a&&(0===a||-1==I.indexOf(e.substr(a-1,1)))&&(L=a),b<u&&(0===u||-1==I.indexOf(e.substr(u-1,1)))&&(L=u),b<h&&(0===h||-1==I.indexOf(e.substr(h-1,1)))&&(L=h),b<p&&(0===p||-1==I.indexOf(e.substr(p-1,1)))&&(L=p),b<l&&(0===l||-1==I.indexOf(e.substr(l-1,1)))&&(L=l),b<f&&(0===f||-1==I.indexOf(e.substr(f-1,1)))&&(L=f),b<d&&(0===d||-1==I.indexOf(e.substr(d-1,1)))&&(L=d),b<m&&(0===m||-1==I.indexOf(e.substr(m-1,1)))&&(L=m),b<v&&(0===v||-1==I.indexOf(e.substr(v-1,1)))&&(L=v),b<y&&(0===y||-1==I.indexOf(e.substr(y-1,1)))&&(L=y),b<E&&(0===E||-1==I.indexOf(e.substr(E-1,1)))&&(L=E),b<g&&(0===g||-1==I.indexOf(e.substr(g-1,1)))&&(L=g),b<w&&(0===w||-1==I.indexOf(e.substr(w-1,1)))&&(L=g),-1!=n&&i<n)this.sections.push(new $(e.substring(0,n))),this.sections.push(new $(e.substring(n+1))),this.operator=new F("+");else if(-1!=i)0<i?this.sections.push(new $(e.substring(0,i))):this.sections.push(new $(0)),this.sections.push(new $(e.substring(i+1))),this.operator=new F("-");else if(0<L&&Math.max(L,b,M,o)==L)this.sections.push(new $(e.substring(0,L))),this.sections.push(new $(e.substring(L))),this.operator=new F("*");else if(-1!=M&&Math.max(M,b,o)==M)this.sections.push(new $(e.substring(0,M))),this.sections.push(new $(e.substring(M))),this.operator=new F("*");else if(-1!=b&&o<b)this.sections.push(new $(e.substring(0,b))),this.sections.push(new $(e.substring(b+1))),this.operator=new F("*");else if(-1!=o)this.sections.push(new $(e.substring(0,o))),this.sections.push(new $(e.substring(o+1))),this.operator=new F("/");else if(-1!=r)this.sections.push(new $(e.substring(0,r))),this.sections.push(new $(e.substring(r+1))),this.operator=new F("^");else if(-1!=a&&Math.max(a,u,h,p,l,f,d,m,v,y)==a)this.sections.push(new $(e.substring(a+3))),this.mathFunction=new O("sin"),this.type="function";else if(-1!=u&&Math.max(u,h,p,l,f,d,m,v,y)==u)this.sections.push(new $(e.substring(u+3))),this.mathFunction=new O("cos"),this.type="function";else if(-1!=h&&Math.max(h,p,l,f,d,m,v,y)==h)this.sections.push(new $(e.substring(h+3))),this.mathFunction=new O("tan"),this.type="function";else if(-1!=p&&Math.max(p,l,f,d,m,v,y)==p)this.sections.push(new $(e.substring(p+4))),this.mathFunction=new O("asin"),this.type="function";else if(-1!=l&&Math.max(l,f,d,m,v,y)==l)this.sections.push(new $(e.substring(l+4))),this.mathFunction=new O("acos"),this.type="function";else if(-1!=f&&Math.max(f,d,m,v,y)==f)this.sections.push(new $(e.substring(f+4))),this.mathFunction=new O("atan"),this.type="function";else if(-1!=d&&Math.max(d,m,v,y)==d)this.sections.push(new $(e.substring(d+3))),this.mathFunction=new O("abs"),this.type="function";else if(-1!=m&&Math.max(m,v,y)==m)this.sections.push(new $(e.substring(m+3))),this.mathFunction=new O("log"),this.type="function";else if(-1!=v&&Math.max(v,y)==v)this.sections.push(new $(e.substring(v+2))),this.mathFunction=new O("ln"),this.type="function";else if(-1!=y)this.sections.push(new $(e.substring(y+4))),this.sections.push(new $("0.5")),this.operator=new F("^");else if(-1!=c){var B=1;for(x=c+1;x<e.length&&0<B;x++)"("==e.substr(x,1)&&B++,")"==e.substr(x,1)&&B--;if(0===B){var H=x-1;0<c&&this.sections.push(new $(e.substring(0,c))),H-c!=1&&this.sections.push(new $(e.substring(c+1,H))),H!=e.length-1&&this.sections.push(new $(e.substring(H+1))),this.operator=new F("*")}else XCalc.log("Brackets nesting error: "+e)}else if(-1!=g&&w<g)0<g?(this.sections.push(new $(e.substring(0,g))),this.sections.push(new $("e")),this.operator=new F("*")):(this.mathConstant=new X("e"),this.type="constant");else if(-1!=w)0<w?(this.sections.push(new $(e.substring(0,w))),this.sections.push(new $("pi")),this.operator=new F("*")):(this.mathConstant=new X("pi"),this.type="constant");else{var C=e.toLowerCase().indexOf("x");-1!=C?0<C?(this.sections.push(new $(e.substring(0,C))),this.sections.push(new $("x")),this.operator=new F("*")):(this.variable="x",this.type="variable"):(this.coefficient=parseFloat(e),this.type="value")}}else if("number"==typeof e)this.coefficient=e,this.type="value";else if(e.simplify){this.coefficient=e.coefficient,this.operator=e.operator,this.mathFunction=e.mathFunction,this.mathConstant=e.mathConstant,this.variable=e.variable,this.type=e.type,this.sections=[];for(var k=0;k<e.sections.length;k++)this.sections.push(new $(e.sections[k]))}}else XCalc.log("Segment has no input.")}var e={errors:[],log:function(e){this.errors.push(e)},clearErrors:function(){this.errors=[]},hasErrors:function(){return this.errors.length},displayErrors:function(){var e=document.createElement("div");e.className="error",e.innerHTML="Errors:";for(var t=document.createElement("ul"),s=0;s<this.errors.length;s++){var n=document.createElement("li");n.innerHTML=this.errors[s],t.appendChild(n)}return e.appendChild(t),e},properBrackets:function(e){for(var t=0,s=0;s<e.length;s++)"("==e.substr(s,1)&&t++,")"==e.substr(s,1)&&t--;return 0===t},createExpression:function(e){return this.properBrackets(e)?new $(e):(this.log("Improperly nested brackets."),0)},graphExpression:function(e,t,s,n,i,o,r){return this.properBrackets(e)?new Graph(e,t,s,n,i,o,r):(this.log("Improperly nested brackets."),0)}};return e}(),derivationMethod=[],rulesUsed=[],vala="1",valb="2";function laTeXed(e){return"$$"+(e=math.parse(e)).toTex({parenthesis:"keep"})+"$$"}function LaTexDeriv(e){var t=e.derivative,s=e.func,n=e.xvalue;return t=math.parse(e.derivative).toTex({parenthesis:"keep"}),s=math.parse(s).toTex({parenthesis:"keep"}),n=n.toTex({parenthesis:"keep"}),"$$\\frac{dn}{du}"+s+"(x)="+t+"$$"}function laTexChainRule(e){console.log(e);var t=e.orig,s=e.derivRule,n=e.rest;return"$$\\frac{dn}{du}"+t.toTex()+"="+s.toTex()+" . \\frac{dn}{du}"+n.toTex()+"$$"}function toHuman(e){return math.format(e,14)}function getDerivative(e){return toHuman(math.derivative(math.parse(e),"x"))}ready(function(){var e="",t="",s=document.getElementById("go-button"),n=["0.7x","-1/3x","x + 1","x - 1","-x","x^2","x / (x^2 + 1)","a * (x^2 + b)","x ^ (-1/3)","e ^ (1 - x)","sqrt(x)","root(7, x + 1)","ln(x)","log(x, 8)","abs(x)","sin(x)","cos(x)","tan(x)","arcsin(x)","arccos(x)","arctan(x)","sec(x)","sinh(x)","arsinh(x)","erf(x)","beta(x, y)","e"],i=document.getElementById("operators").querySelectorAll("div"),o=document.getElementById("examples");try{document.getElementById("main-input"),e=getDerivative(t=inputFirstParser(t="sin(sqrt(e^x + a) / 2)"),e);document.getElementById("derivative-calculator-errors").innerHTML="",setResultHTML(t,e),fireMathJax(),document.getElementById("derivative-calculator-errors").innerHTML="",generateGraph(t,e)}catch(e){if(!parseErrorType(e.toString()).match(/MathJax is not defined/))throw e;console.log("if MathJax error it's ok")}for(var r=0;r<i.length-1;r++)i[r].onclick=function(e){"Del"==this.innerHTML?document.getElementById("main-input").value="":document.getElementById("main-input").value+=this.innerHTML};for(r=0;r<n.length-1;r++){var c="document.getElementById('main-input').value='"+n[r].replace(/\s/g,"")+"';document.getElementById('original-function').innerHTML=laTeXed('"+n[r].replace(/ /g,"")+"');MathJax.Hub.Queue(['Typeset',MathJax.Hub,document.getElementById('original-function')]);";o.innerHTML+="<div id='ex"+r+"' onclick="+c+" class='btn btn-primary btn-sm example'>"+n[r]+"</div>",document.getElementById("ex"+r).onclick=function(){document.getElementById("main-input").value+=this.innerHTML.replace(/\s/g,""),document.getElementById("original-function").innerHTML=laTeXed(this.innerHTML.replace(/ /g,"")),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("original-function")])}}document.getElementById("show-examples-button").onclick=function(){"show"==o.classList[0]?(o.classList.remove("show"),this.innerHTML="Show Examples"):(o.classList.add("show"),this.innerHTML="Hide Examples")},s.onclick=function(){derivationMethod=[],s="",rulesUsed=[];var e=document.getElementById("next-derivative");e&&(e.remove(),document.getElementById("secondary-results").innerHTML="");try{var t=document.getElementById("main-input").value,s=getDerivative(t=inputFirstParser(t),s);document.getElementById("derivative-calculator-errors").innerHTML="",setResultHTML(t,s),document.getElementById("derivative-calculator-errors").innerHTML="",fireMathJax(),generateGraph(t,s)}catch(e){console.log("hmmm there was an error with your input");var n=parseErrorType(e.toString());throw document.getElementById("derivative-calculator-errors").innerHTML=n,e}},document.getElementById("clear-all-button").onclick=function(){document.getElementById("main-input").value=""};for(var a=document.getElementsByClassName("about-box-title"),u=function(e){var s=a[e],n=s.innerHTML.match(/^([^<]*)/g),i=document.getElementById("selected-title"),o=document.getElementById("about-box-content");0==e&&(i.style.left=s.getBoundingClientRect().left+"px"),s.onclick=function(e){i.style.cssText="left:"+s.getBoundingClientRect().left+"px";var t="";switch(console.log(n),n[0]){case"Help":t="Help Me";break;case"Options":t="Here are some Options";break;case"Practice":t="Practice with me";break;default:t='Calculator lets you calculate derivatives of functions online — for free!\r\n\r\n          Our calculator allows you to check your solutions to calculus exercises. It helps you practice by showing you the full working (step by step differentiation).\r\n\r\n          The Derivative Calculator supports computing first, second, …, fifth derivatives as well as differentiating functions with many variables (partial derivatives), implicit differentiation and calculating roots/zeros. You can also check your answers! Interactive graphs/plots help visualize and better understand the functions.\r\n\r\n          For more about how to use the Derivative Calculator, go to "Help" or take a look at the examples.\r\n\r\n          And now: Happy differentiating!'}o.innerHTML=t}},h=0;h<a.length;h++)u(h);document.getElementById("navbar-bar").style.cssText="visibility:visible;";var p=document.getElementById("navbarNavAltMarkup"),l=document.getElementsByClassName("navbar-toggler")[0],f=document.getElementsByClassName("navbar-nav")[0],d=(document.getElementById("about-box"),!1);console.log("fdsfsdfs"),l.onclick=function(){(d=!d)?(p.classList.add("show"),f.classList.add("show")):(p.classList.remove("show"),f.classList.remove("show"))}});var fireMathJax=function(){var e=document.createElement("script");e.type="text/javascript",e.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML",document.getElementsByTagName("head")[0].appendChild(e),MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById("results")])};function ready(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})}function inputFirstParser(e,t){t=[[/arccos/g,"acos"],[/arcsin/g,"asin"],[/arctan/g,"atan"]];for(var s=e,n=0;n<t.length;n++)for(var i;i=t[n][0].exec(s);)s=s.splice(i.index,i[0].length,t[n][1]);return s}function checkReplaceConstants(e,t,s){for(var n,i=[[/([@\s#\$%\^\&\+\=\*\(\)\^\/\-](a)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|(^(a)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|([@\s#\$%\^\&\+\=\*\(\)\^\/\-](a)$)/g,vala],[/([@\s#\$%\^\&\+\=\*\(\)\^\/\-](b)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|(^(b)[@\s#\$%\^\&\+\=\*\(\)\^\/\-])|([@\s#\$%\^\&\+\=\*\(\)\^\/\-](b)$)/g,valb]],o=e.replace(/\s/g,""),r=0;r<i.length;r++)if(null!=o.match(i[r][0]))for(;n=i[r][0].exec(o);)o=0==n.index?o.splice(n.index,1,i[r][1]):n.index==o.length+1?o.splice(n.index,1,i[r][1]):o.splice(n.index+1,1,i[r][1]);return o}function lnParser(e){for(var t,s=e,n=new RegExp("ln","g"),i=[];(t=n.exec(s))&&(i.push(t.index),!(1<i.length&&i[i.length-1]<=i[i.length-2]));){var o=findMatchParenthesisPos(s,t.index+2);if(-1==o)throw s=s.splice(o,1,",e)"),new Error("There is not matchingPar");s=s.splice(t.index,2,"log"),console.log(s)}return s}function findMatchParenthesisPos(e,t){for(var s=0,n=t;n<e.length;n++)if("("==e[n]&&(s+=1),")"==e[n]&&(s-=1),0==s)return n;return-1}var generateGraph=function(e,t){var s=checkReplaceConstants(t),n=checkReplaceConstants(e);s=lnParser(s),n=lnParser(n);var i=new RegExp("ln","g");n.match(i)&&(n=XCalc.createExpression(n).formula()),console.log(s),console.log(n),functionPlot({target:"#quadratic",data:[{fn:s,graphType:"polyline",color:"red",range:[-10,10],nSamples:1e3},{fn:n,graphType:"polyline",color:"black",updateOnMouseMove:!0}]})},setResultHTML=function(e,s){var t=math.format(math.simplify(e));document.getElementById("result-function").innerHTML="",document.getElementById("original-function").innerHTML="",document.getElementById("steps-function").innerHTML="",document.getElementById("rules-used").innerHTML="",document.getElementById("original-function").innerHTML=laTeXed(t);var n=math.format(math.simplify(s));document.getElementById("result-function").innerHTML=laTeXed(s.replace(/ /g,"")),document.getElementById("result-function-simplified").innerHTML=laTeXed(n);var i=document.createElement("div");i.classList.add("copy-button"),i.innerHTML=svgClipboard,document.getElementById("result-function").appendChild(i),i.onclick=function(){copyText(s)},(i=document.createElement("div")).classList.add("copy-button"),i.innerHTML=svgClipboard,document.getElementById("result-function-simplified").appendChild(i),i.onclick=function(){copyText(n)};for(var o=0;o<derivationMethod.length;o++)document.getElementById("steps-function").innerHTML+=LaTexDeriv(derivationMethod[o]);0==rulesUsed.length&&(document.getElementById("rules-used").innerHTML="No chaining rule used!");for(var r=rulesUsed.length-1;0<=r;r--)document.getElementById("rules-used").innerHTML+="By applying the chain rule,"+laTexChainRule(rulesUsed[r])+"<br/>";var c=document.createElement("BUTTON");c.setAttribute("id","next-derivative"),c.classList.add("btn"),c.classList.add("btn-primary"),c.innerHTML="Next derivative",c.onclick=function(){try{var e=getDerivative(s);document.getElementById("derivative-calculator-errors").innerHTML="",appendResultHTML(s,e,2),fireMathJax(),generateGraph(s,e)}catch(e){console.log("hmmm there was an error with your input");var t=parseErrorType(e.toString());throw document.getElementById("derivative-calculator-errors").innerHTML=t,e}},document.getElementById("results").appendChild(c)},appendResultHTML=function t(s,n,i){var e=document.createElement("div"),o=document.createElement("h5"),r=document.createElement("div");switch(i){case 2:o.innerHTML="2nd derivative";break;case 3:o.innerHTML="3rd derivative";break;default:o.innerHTML=i+"th derivative"}if(e.setAttribute("id","derivative-result-"+i),o.classList.add("secondary-derivative-result-title"),e.classList.add("results-mini-container"),e.classList.add("secondary-derivative-result"),r.classList.add("copy-button"),r.innerHTML=svgClipboard,r.onclick=function(){copyText(n)},e.classList.add("mathjax-container"),e.innerHTML=laTeXed(n.replace(/ /g,"")),document.getElementById("secondary-results").appendChild(o),document.getElementById("secondary-results").appendChild(e),e.appendChild(r),i<5)document.getElementById("next-derivative").onclick=function(){try{var e=getDerivative(n);document.getElementById("derivative-calculator-errors").innerHTML="",t(n,e,i+1),fireMathJax(),generateGraph(s,n)}catch(e){console.log("There was an error calculating the next derivative")}};else{var c=document.createElement("h5");c.innerHTML="We can't calculate more than 5 derivatives up",document.getElementById("results").removeChild(document.getElementById("next-derivative")),document.getElementById("results").appendChild(c)}},parseErrorType=function(e){return e.match(/SyntaxError: Parenthesis/g)?"It seems like there is a missing Parenthesis in your function.":e.match(/SyntaxError: Unexpected end of expression/g)?"It seems like your function ends up abruptly.":e.match(/TypeError: Too few arguments in function/g)?"It seems like the "+e.match(/function+\s[a-z][a-z][a-z]/)[0].slice(9,e.length-1)+" function is empty.":e},copyText=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style={position:"absolute",left:"-9999px"},document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};String.prototype.splice||(String.prototype.splice=function(e,t,s){return this.slice(0,e)+s+this.slice(e+Math.abs(t))});var svgClipboard='<svg aria-hidden="true" data-prefix="far" data-icon="clipboard" class="svg-inline--fa fa-clipboard fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path color="white" stroke="#fff" fill="currentColor" d="M336 64h-80c0-35.29-28.71-64-64-64s-64 28.71-64 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 400H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h42v36c0 6.627 5.373 12 12 12h168c6.627 0 12-5.373 12-12v-36h42a6 6 0 0 1 6 6v340a6 6 0 0 1-6 6zM192 40c13.255 0 24 10.745 24 24s-10.745 24-24 24-24-10.745-24-24 10.745-24 24-24"></path></svg>';